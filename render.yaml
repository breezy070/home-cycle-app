# render.yaml

services:
  # 1) Private Mongo (Docker image + persistent disk)
  - type: pserv                # <â€” private service
    runtime: image             # pull a prebuilt image
    name: mongo
    image:
      url: docker.io/library/mongo:7
    plan: starter              # free is NOT allowed for private services
    disk:
      name: mongo-data
      mountPath: /data/db
      sizeGB: 5
    envVars:
      - key: MONGO_INITDB_ROOT_USERNAME
        value: root
      - key: MONGO_INITDB_ROOT_PASSWORD
        sync: false            # set in Render dashboard at creation time

  # 2) API (build from your backend Dockerfile)
  - type: web
    runtime: docker
    name: homecyclehome-api
    branch: main
    dockerfilePath: backend/Dockerfile
    dockerContext: backend
    healthCheckPath: /health
    autoDeployTrigger: commit
    plan: starter              # you can keep this on free if desired, but starter is fine too
    envVars:
      - key: NODE_ENV
        value: production
      - key: JWT_SECRET
        sync: false
      # EITHER enter full URI in dashboard (simplest):
      - key: MONGO_URI
        sync: false
